# Web 服务的用法

在这篇案例中，我们可以很清楚地了解如何根据不同的程序运行环境，动态加载不同的配置文件进而对程序进行隔离。
这当中涉及到的知识点有：

* 如何通过Shell在当前机器中去设置环境变量
* JSON文件作为参数对象动态加载进JS文件中
* 配置文件的编写
* 对程序错误的抓捕
* express中next()函数的作用

> 注意：server.use()的位置顺序。 当在路径使用中间件对url或body内容进行解析的时候，body-parser中间件，应当放置在路由前，而对于请求错误信息的处理，则放在路由后面。因为路由也是server.use()的一部分，当程序抓到err的时候，通常会在路由中直接扔给next()方法，而不是在路由函数中直接进行处理。而next()将错误数据会递交给下一个server.use()通常我们会在该use()中进行错误信息处理。

> 注意：对于get("*") 这样的抓取随机路由的方法，应当放在所有的路由之后。

## Web常见错误

* 404页面的设置
* 权限管控
* 路由重定向
* 不同环境变量的判断

## 错误的领域

* 客户端错误
* 服务端错误
* 日志记录错误

> 对于应用的错误处理的逻辑是，先发现错误，然后在日志中打印出来，在丢给客户端错误进行检查，在排除掉客户端错误后，再将错误丢给服务端检查。对于返回给客户端的错误报警，不仅要返回内容也要将404，500这些状态码一并返回。

